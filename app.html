<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Splitter</title>
</head>
<body>
    <h1>File Splitter</h1>
    <form id="fileForm">
        <label for="fileInput">Select File:</label>
        <input type="file" id="fileInput" accept=".csv" required>
        <br>
        <label for="sizeInput">Max Size (MB):</label>
        <input type="number" id="sizeInput" min="1" value="50" required>
        <br>
        <button type="button" onclick="splitFile()">Split File</button>
    </form>
    <div id="downloadLinks"></div>

    <script>
        function splitFile() {
            const fileInput = document.getElementById('fileInput');
            const sizeInput = document.getElementById('sizeInput');
            const downloadLinks = document.getElementById('downloadLinks');

            if (fileInput.files.length === 0) {
                alert('Please select a file.');
                return;
            }

            const file = fileInput.files[0];
            const maxSize = parseInt(sizeInput.value) * 1024 * 1024; // Convert MB to bytes
            const reader = new FileReader();
            let fileCount = 1;

            reader.onload = function(event) {
                const text = event.target.result;
                const lines = text.split('\n');
                let fileSize = 0;
                let part = [];

                downloadLinks.innerHTML = ''; // Clear previous download links

                for (let line of lines) {
                    const lineSize = new Blob([line]).size;

                    if (fileSize + lineSize > maxSize) {
                        downloadPart(part, fileCount);
                        fileCount++;
                        part = [];
                        fileSize = 0;
                    }

                    part.push(line);
                    fileSize += lineSize;
                }

                if (part.length > 0) {
                    downloadPart(part, fileCount);
                }
            };

            reader.readAsText(file);
        }

        function downloadPart(lines, count) {
            const blob = new Blob([lines.join('\n')], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `part_${count}.csv`;
            a.textContent = `Download part ${count}`;
            document.getElementById('downloadLinks').appendChild(a);
            document.getElementById('downloadLinks').appendChild(document.createElement('br'));
        }
    </script>
</body>
</html>
